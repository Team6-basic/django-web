{% extends 'base.html' %}
{% block content %}
<body>
<nav class="navbar">
    <div class="navwrap">
      <div class="nav_logo_wrap" href="{% url 'hopecharm:index' %}">
        <div class="nav_logo_image"></div>
        <span class="nav_logo_text">희망참</span>
      </div>

      <div class="nav_login">
        <ul>
          <li class="nav-item ">
            {% if user.is_authenticated %}
            <a class="nav-link" href="{% url 'logout' %}">{{ user.username }} (로그아웃)</a>
            {% else %}
            <a class="nav-link" href="{% url 'login'  %}">로그인</a>
            {% endif %}
          </li>
        </ul>
      </div>
    </div>
  </nav>

<div class='container_detail'>
  <div class='det_title'>
    {% for t in title%}
    <h1 style='text-align:center'>{{user.username}}님의 {{t.rec_date}}에 대한 통계입니다.</h1>
    {% endfor %}
  </div>
  <!-- 1행 : 파이그래프 2개-->
  <div class='pie_wrap'>
    <div class='my_pie'><canvas id="myChart3"></canvas></div>   <!--clean 포함-->   
    <div class='v-line'></div>
    <div class='my_pie'><canvas id="myChart4"></canvas></div> <!--clean 미포함-->
  </div>
  <!-- 2행 : 라인그래프 -->
  <div class='line_wrap'>
    <div class='my_line'>        
      {% autoescape off %} {{ fig_timeline_html }} {% endautoescape %}
    </div>
  </div>
  <!-- 3행 : alert 출력(시간, 혐오표현 유형, 키워드 추출 리스트로)-->

</div>
  <!-- vis1 chart.js -->
  <script>
    const datas = {{daily_list_pie}};
    $(function () {
        var ctx_3 = document.getElementById("myChart3").getContext('2d');
        var data_3 = {
          label:'일간 혐오표현 유형별 통계',
            datasets: [{
                data: [datas[9][11], datas[0][2], datas[1][3], datas[2][4], datas[3][5], datas[4][6], datas[5][7],
                datas[6][8], datas[7][9], datas[8][10]],
                backgroundColor: ['#3c8dbc','#f39c12','#dfaebd','#434343','#33115c',
                '#226d1f','#069583','#95c798','#f56954', '#e9c46a'],
            }],
            labels: ["해당없음","여성/가족", "남성", "성소수자", "인종/국적", "연령", "지역", "종교", "기타혐오", "악플/욕설"]
        };
        var mypieChart = new Chart(ctx_3, {
            type: 'pie',
            data: data_3,
            options: {
              layout:{padding:20},
                responsive: false,
                maintainAspectRatio: false,
                plugins:{
                  title:{display:true,text:'일간 혐오표현 유형별 통계(해당없음 포함)'},
                  legend:{
                    labels:{
                      boxWidth:40,
                      boxHeight:5,
                    }
                  }
                },

            }
        });

        var ctx_4 = document.getElementById("myChart4").getContext('2d');
        var data_4 = {
          label:'일간 혐오표현 유형별 통계',
            datasets: [{
                data: [datas[0][2], datas[1][3], datas[2][4], datas[3][5], datas[4][6], datas[5][7],
                datas[6][8], datas[7][9], datas[8][10]],
                backgroundColor: ['#f56954','#f39c12','#dfaebd','#434343','#33115c',
                '#226d1f','#069583','#95c798','#3c8dbc'],
            }],
            labels: ["여성/가족", "남성", "성소수자", "인종/국적", "연령", "지역", "종교", "기타혐오", "악플/욕설"]
        };
        var mypieChart = new Chart(ctx_4, {
            type: 'pie',
            data: data_4,
            options: {
              layout:{padding:20},
                responsive: false,
                maintainAspectRatio: false,
                plugins:{
                  title:{display:true,text:'일간 혐오표현 유형별 통계'},
                  legend:{
                    labels:{
                      boxWidth:40,
                      boxHeight:5,
                    }
                  }
                },

            }
        });
    });
</script>

</body>
{% endblock %}